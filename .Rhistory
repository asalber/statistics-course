setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/statistics_course")
library(tikzDevice)
library(plyr)
library(plotly)
library(shape)
require(Hmisc)
# Color definition
color1<-rgb(5,161,230,max=255)
color2<-rgb(238,50,36,max=255)
color3<-"green3"
color4<-rgb(169,78,145,max=255)
color5<-rgb(238,50,36,alpha=100,max=255)
options(tikzDefaultEngine = "xetex")
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(round(0,0),x0))
polygon(c(x[81],x[81:140],x[140]), c(0,y[81:140],0), col=color5, lty=0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color1, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
text(1.3,0.06,paste("P(X>",x0,")="))
text(1.3,0.04,paste("1-F(",x0,")="))
text(1.3,0.02,"1-0.6985=0.3015")
box()
# Computing probabilities with the normal distribution (left-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_left_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
dev.off()
# Computing probabilities with the normal distribution (right-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_right_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(round(0,0),x0))
polygon(c(x[81],x[81:140],x[140]), c(0,y[81:140],0), col=color5, lty=0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color1, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
text(1.3,0.06,paste("P(X>",x0,")="))
text(1.3,0.04,paste("1-F(",x0,")="))
text(1.3,0.02,"1-0.6985=0.3015")
box()
dev.off()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(round(0,0),x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(format(round(0,0),nsmall=0),x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
c(0,x0)
c(format(0,0),x0)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(format(0,0),x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
format(0,0)
x0
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
# Computing probabilities with the normal distribution (left-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_left_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",x0))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
dev.off()
# Computing probabilities with the normal distribution (right-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_right_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",x0))polygon(c(x[81],x[81:140],x[140]), c(0,y[81:140],0), col=color5, lty=0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color1, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
text(1.3,0.06,paste("P(X>",x0,")="))
text(1.3,0.04,paste("1-F(",x0,")="))
text(1.3,0.02,"1-0.6985=0.3015")
box()
dev.off()
x0
paste(x0)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",paste(x0)))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
tikz(file="img/continuous_random_variables/normal_probability_calculation_left_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",paste(x0)))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
dev.off()
c("0",paste(x0))
cat(x0)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",cat(x0)))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
ar(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0",cat(x0)))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0","0.52"))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
box()
tikz(file="img/continuous_random_variables/normal_probability_calculation_left_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=c(0,x0), labels=c("0","0.52"))
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.6,0.06,paste("F(",x0,")=",p0))
box()
dev.off()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.6,0.06,paste("F(",x0,")=",p0))
box()
# Computing probabilities with the normal distribution (left-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_left_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color5, lty=0)
lines (x, y, type="l")
text(-0.6,0.06,paste("F(",x0,")=",p0))
box()
dev.off()
# Computing probabilities with the normal distribution (right-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_right_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.48, 3.49, by=0.05)
y = dnorm(x,mean=0,sd=1)
x0 = x[81]
p0 = floor(pnorm(x0, mean=0, sd=1, lower.tail=TRUE)*10000)/10000
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", col=color1, lwd=2, yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[81],x[81:140],x[140]), c(0,y[81:140],0), col=color5, lty=0)
polygon(c(x[1],x[1:81],x[81]), c(0,y[1:81],0), col=color1, lty=0)
lines (x, y, type="l")
text(-0.5,0.06,paste("F(",x0,")=",p0))
text(1.3,0.06,paste("P(X>",x0,")="))
text(1.3,0.04,paste("1-F(",x0,")="))
text(1.3,0.02,"1-0.6985=0.3015")
box()
dev.off()
