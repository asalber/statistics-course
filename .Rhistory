setwd("/media/alf/datos/drive/CEU/DOCENCIA/materiales/estadistica/presentaciones/statistics_course")
library(tikzDevice)
library(plyr)
library(plotly)
library(shape)
require(Hmisc)
# Color definition
color1<-rgb(5,161,230,max=255)
color2<-rgb(238,50,36,max=255)
color3<-"green3"
color4<-rgb(169,78,145,max=255)
color5<-rgb(238,50,36,alpha=100,max=255)
options(tikzDefaultEngine = "xetex")
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = pnorm(x0, mean=0, sd=1, lower.tail=TRUE)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:97],x[97]), c(0,y[1:97],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = round(pnorm(x0, mean=0, sd=1, lower.tail=TRUE),4)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:97],x[97]), c(0,y[1:97],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
box()
# Computing probabilities with the normal distribution (left-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_left_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = round(pnorm(x0, mean=0, sd=1, lower.tail=TRUE),4)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:97],x[97]), c(0,y[1:97],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
box()
dev.off()
# Computing probabilities with the normal distribution (right-tail)
tikz(file="img/continuous_random_variables/normal_probability_calculation_right_tail.tex", width=4, height=4)
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = round(pnorm(x0, mean=0, sd=1, lower.tail=TRUE),4)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[97],x[97:length(x)],x[length(x)]), c(0,y[97:length(x)],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
text(1.2,0.06,paste("1-F(",x0,")"))
text(1.2,0.04,"=0.3015")
box()
dev.off()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = round(pnorm(x0, mean=0, sd=1, lower.tail=TRUE),4)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[97],x[97:length(x)],x[length(x)]), c(0,y[97:length(x)],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
text(1.2,0.06,paste("1-F(",x0,")"))
text(1.2,0.04,"=0.3015")
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = round(pnorm(x0, mean=0, sd=1, lower.tail=TRUE),4)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[97],x[97:length(x)],x[length(x)]), c(0,y[97:length(x)],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
text(1.2,0.06,paste("1-F(",x0,")"))
text(1.2,0.04,"=0.3015")
box()
par(mar=c(3.5,3.5,3,1), mgp=c(2.2,0.6,0), las=1)
x = seq(-3.32, 3.32, by=0.04)
y = dnorm(x,mean=0,sd=1)
x0 = x[97]
p0 = round(pnorm(x0, mean=0, sd=1, lower.tail=TRUE),4)
plot(x, y, ylim=c(0,0.45), xlab="X", ylab="Probability density $f(x)$", main="Standard normal distribution $N(0,1)$", type="n", yaxs="i",axes=FALSE)
axis(side=1, at=x0)
polygon(c(x[1],x[1:97],x[97]), c(0,y[1:97],0), col=color5, lty=0)
lines (x, y, type="l", col=color1, lwd=2)
text(-0.7,0.06,paste("F(",x0,")=",p0))
box()
