\section{Discrete random variables}

\mode<presentation>{
%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Discrete random variables}

\tableofcontents[sectionstyle=show/hide,hideothersubsections]
\end{frame}
}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Random variables}
The process of drawing a sample randomly is a random experiment and any variable measured in the sample is a
\emph{random variable} cause the values taken by the variable in the individuals of the sample is a matter of chance.

\begin{definition}[Random variable] 
A \emph{random variable} $X$ is a function that maps every element of the sample space of a random experiment to a real
number.
\[ 
X:\Omega \rightarrow \mathbb{R} 
\]

The set of values that the variable can assume is called \emph{range} and is represented $\mbox{Ran}(X)$.
\end{definition}

In essence, a random variable is a variable whose values come from a random experiment, and every value have
a probability of occurrence. 

\highlight{\textbf{Example}}. The variable $X$ that measures the outcome of rolling a dice is a random variable and its
range is 
\[
\mbox{Ran}(X)=\{1,2,3,4,5,6\}
\]
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Types of random variables}
There are two types of random variables:
\begin{description}
\item[Discrete] They take isolated values, and their range is numerable.\\
Example. Number of children of a family, number of smoked cigarettes, number of subjects passed, etc.
\item[Continuous] They can take any value in an real interval, and their range is non-numerable.\\
Example. Weight, height, age, cholesterol level, etc. 
\end{description}

The way of modelling every type of variable is different. 
In this chapter we are going to study how to model discrete variables.
\end{frame}


\subsection{Probability distribution of a discrete random variable}

%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Probability distribution of a discrete random variable}
As values of a discrete random variable are linked to the elementary events of a random experiment, every value have a
probability. 
\begin{definition}[Probability function]
The \emph{probability function} of a discrete random variable $X$ is the function $f(x)$ that maps every value $x_i$ of
the variable to its probability
\[
f(x_i) = P(X=x_i).
\]
\end{definition}

We can also accumulate probabilities the same way that we accumulated sample frequencies. 

\begin{definition}[Distribution function]
The \emph{distribution function} of a discrete random variable $X$ is the function $F(x)$ that maps every value $x_i$ of
the variable to the probability of having a value less than or equal to $x_i$ 
\[
F(x_i) = P(X\leq x_i) = f(x_1)+\cdots +f(x_i).
\]
\end{definition}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Probability distribution of a discrete random variable}
The range of a discrete random variable and its probability function is known as \highlight{\textbf{Probability
Distribution}} of the variable, and usually it is presented in a table 

\[
\begin{array}{|c|cccc|c|}
\hline
X & x_1 & x_2 & \cdots & x_n & \sum\\ \hline
f(x) & f(x_1) & f(x_2) & \cdots & f(x_n) & 1\\
\hline
F(x) & F(x_1) & F(x_2) & \cdots & F(x_n) =1 &\multicolumn{1}{|c}{} \\
\cline{1-5}
\end{array}
\]

The same way that the sample frequency table shows the distribution of values of a variable in the sample, the
probability distribution of a discrete random variable shows the distribution of values in the whole population. 
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Probability distribution of a discrete random variable}
\framesubtitle{Example of tossing two coins}
Let $X$ be the discrete random variable that measures the number of heads after tossing two coins. 
The  probability tree of the random experiment is 

\begin{center}
\tikzsetnextfilename{discrete_random_variables/two_coins_probability_space}
\mode<article>{\resizebox{0.6\textwidth}{!}{\input{img/discrete_random_variables/two_coins_probability_space}}}
\mode<presentation>{\resizebox{0.6\textwidth}{!}{\input{img/discrete_random_variables/two_coins_probability_space}}}
\end{center}

According to this, the probability distribution of $X$ is 
\[
\begin{array}{|c|ccc|}
\hline
X & 0 & 1 & 2\\ \hline
f(x) & 0.25 & 0.5 & 0.25\\
\hline
F(x) & 0.25 & 0.75 & 1 \\
\hline
\end{array}
\qquad
F(x) =
\begin{cases}
0 & \mbox{si $x<0$}\\
0.25 & \mbox{si $0\leq x< 1$}\\
0.75 & \mbox{si $1\leq x< 2$}\\
1 & \mbox{si $x\geq 2$}
\end{cases}
\]
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Probability distribution charts}
\framesubtitle{Example of tossing two coins}
\begin{center}
\begin{tabular}{cc}
Probability function & Distribution function\\
\tikzsetnextfilename{discrete_random_variables/two_coins_probability_function}
\mode<article>{\resizebox{0.45\textwidth}{!}{\input{img/discrete_random_variables/two_coins_probability_function}}}
\mode<presentation>{\resizebox{0.45\textwidth}{!}{\input{img/discrete_random_variables/two_coins_probability_function}}}
&
\tikzsetnextfilename{discrete_random_variables/two_coins_distribution_function}
\mode<article>{\resizebox{0.45\textwidth}{!}{\input{img/discrete_random_variables/two_coins_distribution_function}}}
\mode<presentation>{\resizebox{0.45\textwidth}{!}{\input{img/discrete_random_variables/two_coins_distribution_function}}}
\end{tabular}
\end{center} 
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Population statistics}
The same way we use sample statistics to describe the sample frequency distribution of a variable, we use
population statistics to describe the probability distribution of a random variable in the whole population.

The population statistics definition is analogous to the sample statistics definition, but using probabilities
instead of relative frequencies. 

The most important are \footnote{To distinguish population statistics from sample statistics we use Greek letters}:
\begin{itemize}
\item \structure{Mean}:
\[
\mu = E(X) = \sum_{i=1}^n x_i f(x_i)
\]
\item \structure{Variance}:
\[
\sigma^2 = Var(X) = \sum_{i=1}^n x_i^2 f(x_i) -\mu^2
\]
\item \structure{Standard deviation}:
\[
\sigma = +\sqrt{\sigma^2}
\]
\end{itemize}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Population statistics}
\framesubtitle{Example of tossing two coins}
In the random experiment of tossing two coins the probability distribution is  
\[
\begin{array}{|c|ccc|}
\hline
X & 0 & 1 & 2\\ \hline
f(x) & 0.25 & 0.5 & 0.25\\
\hline
F(x) & 0.25 & 0.75 & 1 \\
\hline
\end{array}
\]

The main population statistics are 
\begin{align*}
\mu &= \sum_{i=1}^n x_i f(x_i) = 0\cdot 0.25 + 1\cdot 0.5 + 2\cdot 0.25 = 1 \mbox{ heads},\\
\sigma^2 &= \sum_{i=1}^n x_i^2 f(x_i) -\mu^2 = (0^0\cdot 0.25 + 1^2\cdot 0.5 + 2^2\cdot 0.25) - 1^2 = 0.5 \mbox{
heads}^2,\\
\sigma &= +\sqrt{0.5} = 0.71 \mbox{ heads}.
\end{align*}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Discrete probability distribution models}
According to the type of experiment where the random variable is measured, there are different probability distributions
models. 
The most common are

\begin{itemize}
\item Discrete uniform
\item Binomial
\item Poisson 
\end{itemize}
\end{frame}


\subsection{Discrete uniform distribution}

% ---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Discrete uniform probability distribution model $U(a,b)$}
When all the values of a random variable $X$ have equal probability, the probability distribution of $X$ is uniform.

\begin{definition}[Discrete uniform distribution $U(a,b)$]
A discrete random variable $X$ follows a \emph{discrete uniform distribution model} with parameters $a$ and $b$, noted 
$X\sim U(a,b)$, if its range is $\mbox{Ran}(X) = \{a, a+1, \ldots,b\}$ and its probability function is
\[f(x)=\frac{1}{b-a+1}.\]
\end{definition}

Observe that $a$ and $b$ are the minimum and the maximum of the range respectively. 

The mean and the variance are
\[
\mu = \sum_{i=0}^{b-a}\frac{a+i}{b-a+1}=\frac{a+b}{2} \qquad \sigma^2 =\sum_{i=0}^{b-a}\frac{(a+i-\mu)^2}{b-a+1}=
\frac{(b-a+1)^2-1}{12}
\]
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Discrete uniform probability distribution model $U(a,b)$}
\framesubtitle{Example of rolling a dice}
The variable that measures the outcome of rolling a dice follows a discrete uniform distribution model $U(1,6)$.
\begin{center}
\tikzsetnextfilename{discrete_random_variables/discrete_uniform_probability_function}
\mode<article>{\resizebox{0.5\textwidth}{!}{\input{img/discrete_random_variables/discrete_uniform_probability_function}}}
\mode<presentation>{\resizebox{0.55\textwidth}{!}{\input{img/discrete_random_variables/discrete_uniform_probability_function}}}
\end{center}
\end{frame}


\subsection{Binomial distribution}

%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Binomial distribution}
Usually the binomial distribution correspond to a variable measured in a random experiment with the following features:
\begin{itemize}
\item The experiment consist in a sequence of $n$ repetitions of the same trial.
\item Each trial is repeated in identical conditions and produces two possible outcomes known as \emph{Success} or
\emph{Failure}.
\item The trials are independent among them.
\item The probability of Success is the same in all the trials and is $P(\mbox{Success})=p$.
\end{itemize}

Under these conditions, the discrete random variable $X$ that measures the number of successes in the $n$ trials follows
a \emph{binomial distribution model} with parameters $n$ and $p$.
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Binomial distribution model $B(n,p)$}
\begin{definition}[Binomial distribution $(B(n,p)$]
A discrete random variable $X$ follows a \emph{binomial distribution model} with parameters $n$ and $p$, noted 
$X\sim B(n,p)$, if its range is $\mbox{Ran}(X) = \{0,1,\ldots,n\}$ and its probability function is
\[
f(x) = \binom{n}{x}p^x(1-p)^{n-x} = \frac{n!}{x!(n-x)!}p^x(1-p)^{n-x}.
\]
\end{definition}

Observe that $n$ is known as the number of repetitions of a trial and $p$ is known as the probability of Success in
every repetition. 

The mean and the variance are
\[
\mu = n\cdot p \qquad \sigma^2 = n\cdot p\cdot (1-p).
\]
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Binomial distribution model $B(n,p)$}
\framesubtitle{Example of tossing 10 coins}
The variable that measures the number of heads after tossing 10 coins follows a binomial distribution model $B(10,0.5)$.
\begin{center}
\tikzsetnextfilename{discrete_random_variables/binomial_probability_function}
\mode<article>{\resizebox{0.5\textwidth}{!}{\input{img/discrete_random_variables/binomial_probability_function}}}
\mode<presentation>{\resizebox{0.55\textwidth}{!}{\input{img/discrete_random_variables/binomial_probability_function}}}
\end{center}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Binomial distribution model $B(n,p)$}
\framesubtitle{Example of tossing 10 coins}
If $X\sim B(10,\,0.5)$ is the random variable that measures the number of heads after tossing 10 coins, then
\begin{itemize}
\item The probability of getting 4 heads is 
\[
f(4) = \binom{10}{4}0.5^4 (1-0.5)^{10-4} = \frac{10!}{4!6!}0.5^40.5^6 = 210\cdot 0.5^{10} = 0.2051.
\]
\item The probability of getting 2 or less heads is
\begin{align*}
F(2) &= f(0) +f(1) + f(2) =\\
&= \binom{10}{0}0.5^0 (1-0.5)^{10-0} + \binom{10}{1}0.5^1 (1-0.5)^{10-1} + \binom{10}{2}0.5^2 (1-0.5)^{10-2} =\\
&= 0.0547.
\end{align*}
\item And the expected number of heads is
\[ \mu = 10\cdot 0.5 = 5 \mbox{ heads}.\]
\end{itemize}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Binomial distribution function $B(n,p)$}
\framesubtitle{Example of random sampling with replacement}
In a population there are a 40\% of smokers. 
The variable $X$ that measures the number of smokers in a random sample with replacement of 3 persons follows a
binomial distribution model $X\sim B(3,\,0.4)$.

\begin{center}
\tikzsetnextfilename{discrete_random_variables/binomial_probability_space}
\mode<article>{\resizebox{0.7\textwidth}{!}{\input{img/discrete_random_variables/binomial_probability_space}}}
\mode<presentation>{\resizebox{0.65\textwidth}{!}{\input{img/discrete_random_variables/binomial_probability_space}}}
\end{center}

\mode<presentation>{
\scalebox{0.8}{
\[
\renewcommand{\arraystretch}{1.5}
\begin{array}{lll}
\uncover<2->{\only<2>{\color{color2}}f(0)=\binom{3}{0}0.4^0(1-0.4)^{3-0}= 0.6^3,} & \quad &
\uncover<3->{\only<3>{\color{color2}}f(1)=\binom{3}{1}0.4^1(1-0.4)^{3-1}= 3\cdot 0.4\cdot 0.6^2,}\\
\uncover<4->{\only<4>{\color{color2}}f(2)=\binom{3}{2}0.4^2(1-0.4)^{3-2}= 3\cdot 0.4^2\cdot 0.6,} & &
\uncover<5->{\only<5>{\color{color2}}f(3)=\binom{3}{3}0.4^3(1-0.4)^{3-3}= 0.4^3.}
\end{array}
\]
}
}
\mode<article>{
\[
\renewcommand{\arraystretch}{1.5}
\begin{array}{lll}
f(0)=\binom{3}{0}0.4^0(1-0.4)^{3-0}= 0.6^3, & \quad &
f(1)=\binom{3}{1}0.4^1(1-0.4)^{3-1}= 3\cdot 0.4\cdot 0.6^2,\\
f(2)=\binom{3}{2}0.4^2(1-0.4)^{3-2}= 3\cdot 0.4^2\cdot 0.6, & &
f(3)=\binom{3}{3}0.4^3(1-0.4)^{3-3}= 0.4^3.
\end{array}
\]
}
\end{frame}


\subsection{Poisson distribution}

% ---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Poisson distribution}
Usually the Poisson distribution correspond to a variable measured in a random experiment with the following features:
\begin{itemize}
\item The experiment consist in observing the number of events occurring in a fixed interval of time or space.
For instance, number of births in a month, number of emails in one hour, number of red blood cells in a volumen of
blood, etc. 
\item The events occur independently.
\item The experiment produces the same average rate of events $\lambda$ for every interval unit. 
\end{itemize}
Under these conditions, the discrete random variable $X$ that measures the number of events in an interval unit follows
a \emph{Poisson distribution model} with parameter $\lambda$.
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Poisson distribution model $P(\lambda)$}
\begin{definition}[Poisson distribution $P(\lambda)$]
A discrete random variable $X$ follows a \emph{Poisson distribution model} with parameter $\lambda$, noted 
$X\sim P(\lambda)$, if its range is $\mbox{Ran}(X) = \{0,1,\ldots,\infty\}$ and its probability function is
\[
f(x) = e^{-\lambda}\frac{\lambda^x}{x!}.
\]
\end{definition}

Observe that $\lambda$ is the average rate of event for an interval unit, and it will change if the interval change.

The mean and the variance are
\[
\mu = \lambda \qquad \sigma^2 = \lambda.
\]
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Poisson distribution $P(\lambda)$}
\framesubtitle{Example of number of births in a city}
In a city there are an average of 4 births every day. 
The random variable $X$ that measures the number of births in a day in the city follows a Poisson distribution model
$X\sim P(4)$.
\begin{center}
\tikzsetnextfilename{discrete_random_variables/poisson_probability_function}
\mode<article>{\resizebox{0.5\textwidth}{!}{\input{img/discrete_random_variables/poisson_probability_function}}}
\mode<presentation>{\resizebox{0.55\textwidth}{!}{\input{img/discrete_random_variables/poisson_probability_function}}}
\end{center}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Poisson distribution model $P(\lambda)$}
\framesubtitle{Example of number of births in a city}
If $X\sim P(4)$ is the random variable that measures the number of births in the city, then
\begin{itemize}
\item The probability that there are 5 births in a day is
\[
f(5) = e^{-4}\frac{4^5}{5!} = 0.1563.
\]
\item The probability that there are less than 2 births in a day is
\[
F(1) = f(0)+f(1) = e^{-4}\frac{4^0}{0!} + e^{-4}\frac{4^1}{1!} = 5e^{-4} = 0.0916.
\]
\item The probability that there are more than 1 birth a day is 
\[
P(X>1) = 1-P(X\leq 1) = 1-F(1) = 1-0.0916 = 0.9084.
\]
\end{itemize}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Approximation of Binomial by Poisson distribution}
\framesubtitle{Law of rare events}
The Poisson distribution can be obtained from the Binomial distribution when the number of trials repetition tends to
infinite and the probability of Success tends to zero. 

\begin{theorem}[Law or rare events]
The Binomial distribution $X\sim B(n,p)$ tends to the Poisson distribution $P(\lambda)$, with $\lambda=n\cdot p$, when
$n$ tends to infinite and $p$ tends to zero, that is,
\[
\lim_{n\rightarrow \infty, p\rightarrow 0}\binom{n}{x}p^x(1-p)^{n-x} = e^{-\lambda}\frac{\lambda^x}{x!}.
\]
\end{theorem}

In practice, this approximation can be used for $n\geq 30$ and $p\leq 0.1$.
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Approximation of Binomial by Poisson distribution}
\begin{center}
\tikzsetnextfilename{discrete_random_variables/law_rare_events}
\mode<article>{\resizebox{0.6\textwidth}{!}{\input{img/discrete_random_variables/law_rare_events}}}
\mode<presentation>{\resizebox{0.65\textwidth}{!}{\input{img/discrete_random_variables/law_rare_events}}}
\end{center}
\end{frame}


%---------------------------------------------------------------------slide----
\begin{frame}
\frametitle{Approximation of Binomial by Poisson distribution}
\framesubtitle{Example}
A vaccine produce an adverse reaction in 4\% of cases.
If a sample of 50 persons are vaccinated, what is the probability of having more than 2 persons with an adverse
reaction?

The variable that measures the number of persons with an adverse reaction in the sample follows a Binomial distribution
model $X\sim B(50,0.04)$, but as $n=50>30$ and $p=0.04<0.1$, we can apply the law of rare events and use the
Poisson distribution model $P(50\cdot 0.04)=P(2)$ to do the calculations. 
\begin{align*}
P(X>2) &= 1-P(X\leq 2) = 1-f(0)-f(1)-f(2) =\\
&= 1-e^{-2}\frac{2^0}{0!}-e^{-2}\frac{2^1}{1!}-e^{-2}\frac{2^2}{2!} =\\
&= 1-5e^{-2} = 0.3233.
\end{align*}
\end{frame}

